<include file = "./tmp_mobile/Admin/Public/common.html" />
<include file = "./tmp_mobile/Admin/Public/list.html" />
<div class="content" style="background-color: #fff;">
    <div class="con">
        <div class="right" >
            <div class="aps-tab-bar aps-tab-bar-type-card aps-tab-bar-align-left aps-tab-bar-size-small">
                <div class="aps-tab-bar-wrapper" style="width: 100%;">
                    <div class="aps-tab-item-wrapper">
                        <div class="aps-tab-label aps-tab-label-active aps-tab-label-col-5">
                            <span class="aps-tab-label-inner"><a class="tabs" href="javascript:;">转写列表</a></span>
                        </div>
                        <div class="aps-tab-label  aps-tab-label-col-5">
                            <span class="aps-tab-label-inner"><a class="tabs" href="{:U('Truncate/log')}">转写日志</a></span>
                        </div>
                    </div>
                </div>
            </div>

            <form class="clearfix search" id="_form1" method="post" action="{:U('/Truncate/index')}">
                    <div class="filter">
                        <div class="aps-widget aps-ani-transition aps-grid aps-grid-fluid aps-state-visible">
                            <div class="aps-ani-transition aps-grid-row aps-state-visible">
                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-2 aps-state-visible legend title" style="padding: 8px;"> 转写内容:</div>
                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-4 aps-state-visible" style="padding: 8px;"><input type="text" placeholder="请填写搜索内容" class="aps-ani-transition aps-widget aps-corner-tl aps-corner-tr aps-corner-bl aps-corner-br aps-input aps-size-small" name="keywords" value="{$keywords}"></div>

                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-2 aps-state-visible legend title" style="padding: 8px;"> 转写时间:</div>
                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-4 aps-state-visible" style="padding: 8px;"><input type="text" id="start-one" placeholder="最小值" class="datainp aps-ani-transition aps-widget aps-corner-tl aps-corner-tr aps-corner-bl aps-corner-br aps-input aps-size-small" name="start_date" value="{$start_date}" readonly></div>    

                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-2 aps-state-visible legend title" style="padding: 8px;"> 转写时间:</div>
                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-4 aps-state-visible" style="padding: 8px;"><input type="text" id="start-two" placeholder="最大值" class=" datainp aps-ani-transition aps-widget aps-corner-tl aps-corner-tr aps-corner-bl aps-corner-br aps-input aps-size-small" name="end_date" value="{$end_date}" readonly></div>
                            </div>

                            <div class="aps-ani-transition aps-grid-row aps-state-visible">
                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-24 aps-state-visible search-button " style="padding: 8px;">
                                    <button type="button" class="aps-ani-transition aps-widget aps-corner-tl aps-corner-tr aps-corner-bl aps-corner-br aps-btn aps-btn-primary aps-size-small btn" onclick="$('#_form1').submit();">搜索</button>
                                    <button type="button" class="aps-ani-transition aps-widget aps-corner-tl aps-corner-tr aps-corner-bl aps-corner-br aps-btn aps-btn-normal aps-size-small btn" onclick="$('input').val('')">重置</button>
                                    <button type="button" class="aps-ani-transition aps-widget aps-corner-tl aps-corner-tr aps-corner-bl aps-corner-br aps-btn aps-btn-normal aps-size-small btn float-btn" onclick="excel()">导出列表</button>
                                    <if condition="$round neq null">
                                    <button type="button" class="aps-ani-transition aps-widget aps-corner-tl aps-corner-tr aps-corner-bl aps-corner-br aps-btn aps-btn-normal aps-size-small btn float-btn" style="color:red">出现率：{$round}%</button>
                                    </if>
                                </div>
                            </div>
                        </div>
                    </div>
            </form>

            <div class="formation clearfix" style="margin-top: 2px;">
                <table>
                    <tr>
                        <th style="width: 20px"><input type="checkbox" id="allSelect"  onclick="$('._ids').prop('checked',$(this).prop('checked'))"></th>
                        <th style="width:80px">文字内容</th>
                        <th>对应设备</th>
                        <th>对应端口</th>
                        <th>对应文件</th>
                        <th>转写时间</th>
                        <th>操作</th>
                    </tr> 
                </table>
            </div>

            <form id="_form" name="_form" action="/device/setGroup" method="post" onsubmit="return false;">
            <div class="formation clearfix" style="border: 1px solid #e7e7e7;border-top: none;">
                <table >
                    <foreach name="data" key="key" item="val">
                    <tr class="one">
                        <td style="width: 20px"><input type="checkbox" class="J_check _ids" name="ids[]" value="{$val['id']}"></td>
                        <td style="color:#06C;width:80px;" title="{$val.content}"><div style="white-space: nowrap;overflow:hidden;text-overflow: ellipsis;">{$val['content']}</div>
                        </td>
                        <td>{$val.name}</td>
                        <td>{$val.portname}</td>
                        <td>{$val.files}</td>
                        <td>{$val.time|date="Y-m-d H:i:s",###}</td>
                        <td>
                            <a href="{:U('Truncate/detail',array('id'=>$val['id']))}" >详情</a>
                        </td>
                    </tr>
                    </foreach>
                </table>
            </div>
            </form>
            <div class="pages" style="font-size: 14px;">
                {$Page}
            </div>
        </div>
    </div>
</div>
<include file = "./tmp/Admin/Public/list_js.html" />
<script type="text/javascript">
    //导出表格
    function excel(){
        var url = "{:U('Truncate/index_excel',array('start_date'=>$start_date,'end_date'=>$end_date,'keywords'=>$keywords,'excel'=>1))}";
        location.href=url;
        
    }
</script>