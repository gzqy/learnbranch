<include file = "./tmp_mobile/Admin/Public/common.html" />
<include file = "./tmp_mobile/Admin/Public/list.html" />
<div class="content" style="background-color: #fff;">
    <div class="con" style="width:100%;">
        <div class="right" >
            <div class="aps-tab-bar aps-tab-bar-type-card aps-tab-bar-align-left aps-tab-bar-size-small">
                <div class="aps-tab-bar-wrapper" style="width: 100%;">
                    <div class="aps-tab-item-wrapper">
                        <if condition="$status eq 1">
                            <div class="aps-tab-label  aps-tab-label-col-5">
                                <span class="aps-tab-label-inner"><a class="tabs" href="{:U('/Admin/Device/status',array('status'=>0))}">全部设备({$count['total']})</a></span>
                            </div>
                            <div class="aps-tab-label aps-tab-label-active aps-tab-label-col-5">
                                <span class="aps-tab-label-inner"><a class="tabs" href="javascript:;">在线设备({$count['inline']})</a></span>
                            </div>
                            <div class="aps-tab-label aps-tab-label-col-5">
                                <span class="aps-tab-label-inner"><a class="tabs" href="{:U('/Admin/Device/status',array('status'=>2))}">离线设备({$count['out']})</a></span>
                            </div>
                        <elseif condition="$status eq 2" />
                            <div class="aps-tab-label  aps-tab-label-col-5">
                                <span class="aps-tab-label-inner"><a class="tabs" href="{:U('/Admin/Device/status',array('status'=>0))}">全部设备({$count['total']})</a></span>
                            </div>
                            <div class="aps-tab-label aps-tab-label-col-5">
                                <span class="aps-tab-label-inner"><a class="tabs" href="{:U('/Admin/Device/status',array('status'=>1))}">在线设备({$count['inline']})</a></span>
                            </div>
                            <div class="aps-tab-label aps-tab-label-active aps-tab-label-col-5">
                                <span class="aps-tab-label-inner"><a class="tabs" href="javascript:;">离线设备({$count['out']})</a></span>
                            </div>
                        <else />
                            <div class="aps-tab-label aps-tab-label-active aps-tab-label-col-5">
                                <span class="aps-tab-label-inner"><a class="tabs" href="javascript:;">全部设备({$count['total']})</a></span>
                            </div>
                            <div class="aps-tab-label aps-tab-label-col-5">
                                <span class="aps-tab-label-inner"><a class="tabs" href="{:U('/Admin/Device/status',array('status'=>1))}">在线设备({$count['inline']})</a></span>
                            </div>
                            <div class="aps-tab-label aps-tab-label-col-5">
                                <span class="aps-tab-label-inner"><a class="tabs" href="{:U('/Admin/Device/status',array('status'=>2))}">离线设备({$count['out']})</a></span>
                            </div>
                        </if>
                    </div>
                </div>
            </div>

            <form class="clearfix search" id="_form1" method="post" action="{:U('/Admin/Device/status')}">
                    <div class="filter">
                        <div class="aps-widget aps-ani-transition aps-grid aps-grid-fluid aps-state-visible">
                            <div class="aps-ani-transition aps-grid-row aps-state-visible">
                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-2 aps-state-visible legend title" style="padding: 8px;"> 设备名称:</div>
                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-4 aps-state-visible" style="padding: 8px;"><input type="text" placeholder="请填写设备名称" class="aps-ani-transition aps-widget aps-corner-tl aps-corner-tr aps-corner-bl aps-corner-br aps-input aps-size-small" name="name" value="{$name}"></div>

                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-2 aps-state-visible legend title" style="padding: 8px;"> 设备分组:</div>
                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-4 aps-state-visible" style="padding: 8px;">
                                    <select name="group_id"  class="aps-ani-transition aps-widget aps-corner-tl aps-corner-tr aps-corner-bl aps-corner-br aps-input aps-size-small" style="padding: 4px;">
                                        <option class="option" value='0'>全部分组</option>
                                        <foreach name="groups" item="val" key="key">
                                            <if condition="$group_id eq $key">
                                                <option class="option" value="{$key}" selected="selected">{$val}</option>
                                            <else />
                                                <option class="option" value="{$key}">{$val}</option>
                                            </if>
                                        </foreach>
                                    </select>
                                </div>

                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-2 aps-state-visible legend title" style="padding: 8px;"> 关键名词:</div>
                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-4 aps-state-visible" style="padding: 8px;"><input type="text" placeholder="请填写关键名词" class="aps-ani-transition aps-widget aps-corner-tl aps-corner-tr aps-corner-bl aps-corner-br aps-input aps-size-small" name="keywords" value="{$keywords}"></div>
                                
                            </div>
                            
                            <div class="aps-ani-transition aps-grid-row aps-state-visible">
                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-2 aps-state-visible legend title" style="padding: 8px;"> 设备编码:</div>
                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-4 aps-state-visible" style="padding: 8px;"><input type="text" placeholder="请填写设备编码" class="aps-ani-transition aps-widget aps-corner-tl aps-corner-tr aps-corner-bl aps-corner-br aps-input aps-size-small" name="code" value="{$code}"></div>

                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-2 aps-state-visible legend title" style="padding: 8px;"> 设备时间:</div>
                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-4 aps-state-visible" style="padding: 8px;"><input type="text" id="start-one" placeholder="最小值" class="datainp aps-ani-transition aps-widget aps-corner-tl aps-corner-tr aps-corner-bl aps-corner-br aps-input aps-size-small" name="start_date" value="{$start_date}" readonly></div>    

                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-2 aps-state-visible legend title" style="padding: 8px;"> 设备时间:</div>
                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-4 aps-state-visible" style="padding: 8px;"><input type="text" id="start-two" placeholder="最大值" class=" datainp aps-ani-transition aps-widget aps-corner-tl aps-corner-tr aps-corner-bl aps-corner-br aps-input aps-size-small" name="end_date" value="{$end_date}" readonly></div>
                                
                            </div>

                            <div class="aps-ani-transition aps-grid-row aps-state-visible">
                                <div class="aps-ani-transition aps-grid-col aps-grid-col-md-24 aps-state-visible search-button" style="padding: 8px;">
                                    <button type="button" class="aps-ani-transition aps-widget aps-corner-tl aps-corner-tr aps-corner-bl aps-corner-br aps-btn aps-btn-primary aps-size-small btn" onclick="$('#_form1').submit();">搜索</button>
                                    <button type="button" class="aps-ani-transition aps-widget aps-corner-tl aps-corner-tr aps-corner-bl aps-corner-br aps-btn aps-btn-normal aps-size-small btn" onclick="$('input').val('')">重置</button>
                                    <button type="button" class="aps-ani-transition aps-widget aps-corner-tl aps-corner-tr aps-corner-bl aps-corner-br aps-btn aps-btn-normal aps-size-small btn float-btn" onclick="excel('{:U('Device/index_excel')}')">导出列表</button>
                                </div>
                            </div>
                        </div>
                    </div>
            </form>
            <input type="hidden" name="gdata" id="gdata" value={$gdata} />
            

            <div class="formation clearfix" style="border: 1px solid #e7e7e7;border-top: none;">
                    <table >
                        <foreach name="data" key="key" item="val">
                        <tr class="one">
                            <td style="width:100%;">
                                <div style="width: 100%;">名称 {$val['name']}&nbsp;&nbsp;&nbsp;&nbsp;状态 <if condition="$val['status'] eq 1">
                                    <img src="./public/resource/images/online.png" style="width:1rem;display:inline-block;" title='在线'>
                                <else />
                                    <img src="./public/resource/images/off.png" style="width:1rem;display:inline-block;" title="离线">
                                </if></div>
                                <div style="width: 100%;">
                                    <span>来电：<span class="_comeing_{$val['id']}" >{$val['comeing']}</span>  
                                    <span style="margin-left:5px;">
                                    去电：<span class="_outgoing_<?=$val['device_id'] ?>" >{$val['outgoing']}</span></span>
                                    <span style="margin-left:5px;">
                                    未接：<span class="_missed_<?=$val['device_id'] ?>" >{$val['missed']}</span> </span>
                                    <span style="margin-left:5px;">事件：<span class="_case_{$val['id']}" >{$val['case']}</span></span>
                                </div>
                                <div style="width: 100%;">
                                    <a href="{:U('Admin/Device/showLine',array('id'=>$val['id']))}">端口</a><i>|</i>
                                    <a href="{:U('Admin/Device/showLogs',array('id'=>$val['id']))}">记录</a><i>|</i>
                                    <a href="{:U('Admin/Device/showCase',array('id'=>$val['id']))}">事件</a><i>|</i>
                                    <a href="{:U('Admin/Device/showLine',array('id'=>$val['id']))}">设备</a>
                                </div>
                            </td>
                        </tr>
                        </foreach>
                    </table>
            </div>
            
            <div class="pages" style="font-size:0.8rem;">
                {$Page}
            </div>
        </div>
    </div>
</div>
<include file = "./tmp/Admin/Public/list_js.html" />
<script type="text/javascript" src="./public/resource/js/device.js"></script>