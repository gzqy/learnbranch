<include file = "./tmp/Admin/Public/common.html" />
<include file = "./tmp/Admin/Public/list.html" />
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="__ROOT__/public/assets/vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="__ROOT__/public/assets/vendor/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="__ROOT__/public/assets/css/main.css">
</head>
<div class="content" style="background-color: #fff;">
    <div class="con" style="width:1216px;">
    	<dl class="nav" >
            <dt><b>●</b>数据统计</dt>
            <foreach name="second_nav" item="vo">
            	<if condition="$second_nav_id eq $vo['id']">
            		<dd class="bg"><a href="javascript:;"><b>●</b>{$vo.name}</a></dd>
            	<else />
            		<dd><a href="{$vo.a}"><b>●</b>{$vo.name}</a></dd>
            	</if>
            </foreach>
            
        </dl>

        <div class="right" >
        	<div class="aps-tab-bar aps-tab-bar-type-card aps-tab-bar-align-left aps-tab-bar-size-small">
                <div class="aps-tab-bar-wrapper" style="width: 100%;">
                    <div class="aps-tab-item-wrapper">
                        <div class="aps-tab-label aps-tab-label-active aps-tab-label-col-5">
                            <span class="aps-tab-label-inner"><a class="tabs" href="javascript:;">数据统计结果</a></span>
                        </div>
                    </div>
                </div>
            </div>

            <div id="wrapper">
            	<div class="main" style="width:100%;">
            		<div class="main-content">
            			<div class="container-fluid">
            				 <div class="panel panel-headline">
	                            <div class="panel-body">
	                               	<div class="row"></div>
	                                <div class="row">
	                                    <div class="col-md-9" style="width:100%;">
	                                        <div id="headline-chart2" class="ct-chart" style="width:100%;height:400px;"></div>
	                                    </div>
	                                </div>
	                            </div>
	                        </div>

	                        <div class="panel panel-headline">
	                            <div class="panel-body">
	                                <div class="row">
	                                    <div class="col-md-3" style="width:33%;">
	                                        <div class="metric">
	                                            <span class="icon"><i class="fa fa-shopping-bag"></i></span>
	                                            <p>
	                                                <span class="number">{$data['all']['coming']}</span>
	                                                <span class="title">来电记录</span>
	                                            </p>
	                                        </div>
	                                    </div>
	                                    <div class="col-md-3" style="width:33%;">
	                                        <div class="metric">
	                                            <span class="icon"><i class="fa fa-eye"></i></span>
	                                            <p>
	                                                <span class="number">{$data['all']['outing']}</span>
	                                                <span class="title">去电记录</span>
	                                            </p>
	                                        </div>
	                                    </div>
	                                    <div class="col-md-3" style="width:33%;">
	                                        <div class="metric">
	                                            <span class="icon"><i class="fa fa-bar-chart"></i></span>
	                                            <p>
	                                                <span class="number">{$data['all']['miss']}</span>
	                                                <span class="title">未接记录</span>
	                                            </p>
	                                        </div>
	                                    </div>
	                                </div>

	                                 

	                                <div class="row">
	                                    <div class="col-md-9" style="width:100%;">
	                                        <div id="headline-chart1" class="ct-chart" style="width:100%;height:300px;"></div>
	                                    </div>
	                                </div>
	                            </div>
	                        </div>

	                      
            			</div>
            		</div>
            	</div>
            </div>	
        </div>
    </div>
</div>
<script src="__ROOT__/public/echarts/dist/echarts.js"></script>
<script type="text/javascript">
	var type = "{$type}";
	 require.config({
            paths: {
                echarts: 'public/echarts/dist'
            }
        });
	 	//权限设备数量处理
        require(
            [
                'echarts',
                'echarts/chart/line',   // 按需加载所需图表，如需动态类型切换功能，别忘了同时加载相应图表
                'echarts/chart/bar',
                'echarts/chart/pie',
            ],
            function (ec) {
               
                var myChart1 = ec.init(document.getElementById('headline-chart1'),'dark');
                var comeing = "{$data['all']['coming']}";
                var outgoing = "{$data['all']['outing']}";
                var missed = "{$data['all']['miss']}";
                var option =  {
		            title: {
		                text: '所有记录统计',
		                align:'center'
		            },
		            tooltip: {
		            	trigger: 'item',
        				formatter: "{a} <br/>{b} : {c} ({d}%)",
		            },
		            legend: {
		            	left: 'left',
		            	// orient: 'vertical',
		            	
		                data: ["来电记录","去电记录","未接记录"]
		            },
		             toolbox: {
		                show : true,
		                feature : {
		                    mark : {show: true},
		                    dataView : {show: true, readOnly: false},
		                    magicType : {show: true, type: ['line', 'bar','pie']},
		                    restore : {show: true},
		                    saveAsImage : {show: true}
		                }
		            },
		            series: [{
		                name: '记录条数',
		                type: 'pie',
			            radius : '55%',
			            center: ['50%', '60%'],
			            data:[
			                {value:comeing, name:'来电记录'},
			                {value:outgoing, name:'去电记录'},
			                {value:missed, name:'未接记录'},
			            ],
			            itemStyle: {
			                emphasis: {
			                    shadowBlur: 10,
			                    shadowOffsetX: 0,
			                    shadowColor: 'rgba(0, 0, 0, 0.5)'
			                }
			            }
		            }]
		        };
                myChart1.setOption(option);

               

				var myChart2 = ec.init(document.getElementById('headline-chart2'));

				var option = <?php echo $data['option'] ?>;
				console.log(option);
				myChart2.setOption(option);
            }

        );
	
</script>